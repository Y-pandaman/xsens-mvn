# Copyright (C) 2018 Istituto Italiano di Tecnologia (IIT). All rights reserved.
# This software may be modified and distributed under the terms of the
# GNU Lesser General Public License v2.1 or any later version.

# For every system generate thrift libraries
yarp_idl_to_dir("${CMAKE_CURRENT_SOURCE_DIR}/thrift/XsensFrame.thrift"
                "${CMAKE_CURRENT_BINARY_DIR}/autogenerated/data"
                THRIFT_SOURCES
                THRIFT_HEADERS
                THRIFT_INCLUDE_DIRS)

yarp_idl_to_dir("${CMAKE_CURRENT_SOURCE_DIR}/thrift/XsensDriverService.thrift"
                "${CMAKE_CURRENT_BINARY_DIR}/autogenerated/services"
                THRIFT_SERVICE_SOURCES
                THRIFT_SERVICE_HEADERS
                THRIFT_SERVICE_INCLUDE_DIRS)

add_library(xsens_mvn_idl STATIC ${THRIFT_SOURCES}
                                 ${THRIFT_HEADERS}
                                 ${THRIFT_SERVICE_SOURCES}
                                 ${THRIFT_SERVICE_HEADERS})

target_include_directories(xsens_mvn_idl SYSTEM PUBLIC ${THRIFT_INCLUDE_DIRS}
                                                       ${THRIFT_SERVICE_INCLUDE_DIRS}
                                                       ${YARP_INCLUDE_DIRS})

target_link_libraries(xsens_mvn_idl YARP::YARP_OS)

install(TARGETS xsens_mvn_idl
        RUNTIME DESTINATION ${CMAKE_INSTALL_FULL_BINDIR}
        ARCHIVE DESTINATION ${CMAKE_INSTALL_FULL_LIBDIR}
        LIBRARY DESTINATION ${CMAKE_INSTALL_FULL_LIBDIR})
